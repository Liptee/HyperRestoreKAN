# Инструкия по запуску
1. Копируем репозиторий:
`HTTPS:`
```bash
git clone https://github.com/Liptee/HyperRestoreKAN.git
```

`SSH:`
```bash
git@github.com:Liptee/HyperRestoreKAN.git
```

2. Внутри директории соберите docker контейнер:
```bash
docker build -t container_name .
```

3. Запустите контейнер
Используете команду `docker run` для запуска созданного контейнера. Обратите внимание на следующие флаги при запуске:
- `-it` – для того, чтобы попасть во внутренний терминал контейнера;
- `-v` – для того. чтобы замапить директории проекта и данных внутрь контейнера;
- `--gpus` – указать индексы графических ускорителей;
- `--shm-size` – для выделения общей памяти контейнеру.

4. Обучение
Для запуска обучения вам понадобится конфигурационный файл. Там же вы можете выставить все настройки обучения. Примеры конфигурационных файлов вы можете найти в директории `configs`. Команда для запуска обучения:
```bash
python main.py train -c path/to/config.yaml
```
Результаты обучения (метрики, веса, цветосинтез гиперспектральных изображений в сравнении) вы можете найти в папке `experiments`.

5. Тестирование
Во время тестирования производится инференс `mat` файлов, которые указаны в конфигурационном файле в качестве тестового набора.
Команда для запуска тестирования:
```bash
python main.py test -c path/to/config.yaml -w path/to/weights.ckpt
```

# Данные
Для запуска на наборе CAVE вам понадобятся данные оригинального набора [CAVE](https://ieee-dataport.org/documents/cave-hsi) а также их таргетированная версия (например полученная при помощи алгоритмов деградации). Вы можете найти все необходимые данные по [ссылке](https://www.kaggle.com/datasets/liptee/hyperspectral-image-restoration-based-on-cave).

Использованные алгоритмы деградации вы сможете найти в другом [репозитории](https://github.com/Liptee/HSI-Fresnel-Lens).
